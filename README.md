# Neoversity. Algorithms 2. Homework 3-4

## Встановлення

Цей проєкт використовує Poetry для керування залежностями.

### 1. Передумови

Переконайтеся, що у вас встановлено Poetry. Якщо ні, ви можете встановити його, дотримуючись [офіційної інструкції](https://python-poetry.org/docs/#installation).

### 2. Клонуйте репозиторій

```bash
git clone https://github.com/atoptun/goit-algo2-hw-04
cd goit-algo2-hw-04
```

### 3. Встановіть залежності

Для збереження віртуального середовища використовується каталог проекту.

```bash
poetry install
```

### 4. Запуск

Для запуску використовуйте команди

```bash
# Task 1
poetry run python src/task_1.py
# Task 2
poetry run python src/task_2.py
```

## Завдання 1. Застосування алгоритму максимального потоку для логістики товарів

Розробіть програму для моделювання мережі потоків для логістики товарів зі складів до магазинів, використовуючи алгоритм максимального потоку. Проведіть аналіз отриманих результатів і порівняйте їх з теоретичними знаннями.

Опис завдання

Побудуйте модель графа, що представляє мережу потоків у наступному зображені:

![Task 1 Graph](data/task1_example.png)

Зв'язки та пропускні здатності у графі мають наступний вигляд:

|Від | До | Пропускна здатність (одиниць)|
|----|----|-----|
|Термінал 1|Склад 1|25|
|Термінал 1|Склад 2|20|
|Термінал 1|Склад 3|15|
|Термінал 2|Склад 3|15|
|Термінал 2|Склад 4|30|
|Термінал 2|Склад 2|10|
|Склад 1|Магазин 1|15|
|Склад 1|Магазин 2|10|
|Склад 1|Магазин 3|20|
|Склад 2|Магазин 4|15|
|Склад 2|Магазин 5|10|
|Склад 2|Магазин 6|25|
|Склад 3|Магазин 7|20|
|Склад 3|Магазин 8|15|
|Склад 3|Магазин 9|10|
|Склад 4|Магазин 10|20|
|Склад 4|Магазин 11|10|
|Склад 4|Магазин 12|15|
|Склад 4|Магазин 13|5|
|Склад 4|Магазин 14|10|

Застосуйте алгоритм максимального потоку для вирішення задачі. Напишіть програму, що реалізує алгоритм Едмондса-Карпа, або скористайтеся вже реалізованою версією для знаходження максимального потоку в побудованому графі. Проведіть аналіз отриманого результату. Чи досягнуто оптимального потоку, і що це означає для розглянутої мережі?

Оформіть звіт з розрахунками та поясненнями. Поясніть, які вершини та ребра було вибрано, як вони відповідають реальним елементам логістичної системи. Покажіть покроковий розрахунок максимального потоку та пояснити логіку кожного кроку.

Технічні умови

1. Використовуйте алгоритм Едмондса-Карпа для реалізації максимального потоку.

2. Побудова графа повинна відповідати наведеній структурі з 20 вершинами та заданими пропускними здатностями.

### Реалізація [task_1.py](src/task_1.py)

Для запуску використовуйте команду

```bash
poetry run python src/task_1.py
```

#### Граф з пропускною здатністтю потоків

![Task 2 Weights](data/task1_weights.png)

#### Таблиця з результатами потоків

Загальний потік мережі: 115.0 одиниць

| Термінал   | Магазин    |   Фактичний Потік (одиниць) |
|:-----------|:-----------|----------------------------:|
| Термінал 1 | Магазин 1  |                          15 |
| Термінал 1 | Магазин 2  |                          10 |
| Термінал 1 | Магазин 3  |                           0 |
| Термінал 1 | Магазин 4  |                          15 |
| Термінал 1 | Магазин 5  |                           5 |
| Термінал 1 | Магазин 6  |                           0 |
| Термінал 1 | Магазин 7  |                          15 |
| Термінал 1 | Магазин 8  |                           0 |
| Термінал 1 | Магазин 9  |                           0 |
| Термінал 1 | Магазин 10 |                           0 |
| Термінал 1 | Магазин 11 |                           0 |
| Термінал 1 | Магазин 12 |                           0 |
| Термінал 1 | Магазин 13 |                           0 |
| Термінал 1 | Магазин 14 |                           0 |
| Термінал 2 | Магазин 1  |                           0 |
| Термінал 2 | Магазин 2  |                           0 |
| Термінал 2 | Магазин 3  |                           0 |
| Термінал 2 | Магазин 4  |                           0 |
| Термінал 2 | Магазин 5  |                           5 |
| Термінал 2 | Магазин 6  |                           5 |
| Термінал 2 | Магазин 7  |                           5 |
| Термінал 2 | Магазин 8  |                          10 |
| Термінал 2 | Магазин 9  |                           0 |
| Термінал 2 | Магазин 10 |                          20 |
| Термінал 2 | Магазин 11 |                          10 |
| Термінал 2 | Магазин 12 |                           0 |
| Термінал 2 | Магазин 13 |                           0 |
| Термінал 2 | Магазин 14 |                           0 |

### Висновки

У ході виконання цього завдання було побудовано модель логістичної мережі у вигляді орієнтованого графа та застосовано алгоритм Едмондса-Карпа для знаходження максимального потоку.

#### Покроковий розрахунок максимального потоку

Для розрахунку максимального потоку всієї системи були додані початкова вершина `START` і кінцева вершина `END`. Також додані умовно безкінечні ребра від `START` до терміналів і від кожного магазина до `END`. Це дозволило алгоритму Едмондса-Карпа прокласти всі можливі шляхи в заданій системі від `START` до `END` і побудувати матрицю фактичних потоків.

На основі матриці фактичних потоків було проведено декомпозицію шляхів від терміналів до кожного магазину з агрегацією проведеної кількості товарів. При декомпозиції шляхів використовується алгоритм DFS для пошуку шляхів між терміналами і магазинами.

#### Аналіз оптимальності та результатів

Застосований алгоритм Едмондса-Карпа гарантує знаходження оптимального потоку між одним джерелом та одним стоком, тож знайдений потік в **115 од.** являється максимальним для заданої мережі.

#### Відповіді на запитання

1. **Які термінали забезпечують найбільший потік товарів до магазинів?**

    Згідноз розрахунками кожен термінал забезпечив наступну кількість товарів.

    | Термінал   |   Відправлено (одиниць) |
    |:-----------|------------------------:|
    | Термінал 1 |                      60 |
    | Термінал 2 |                      55 |

2. **Які маршрути мають найменшу пропускну здатність і як це впливає на загальний потік?**

    Найменьша пропускна здатність маршрутів `Т1-М3`, `Т1-М6`, `Т1-М8`, `Т1-М9`, `Т2-М4`, `Т2-М9`, `Т2-М12`, `Т2-М13`, `Т2-М14` дорівнює `0 од.`. Це суттєво впливає на загальний потік системи, тому що вузькі місця на цих маршрутах не дозволяють доствляти товари.

3. **Які магазини отримали найменше товарів і чи можна збільшити їх постачання, збільшивши пропускну здатність певних маршрутів?**

    Згідно з розрахунками побудована таблиця надходження товарів по всім магазинам.

    | Магазин    |   Отримано (одиниць) |
    |:-----------|---------------------:|
    | Магазин 3  |                    0 |
    | Магазин 9  |                    0 |
    | Магазин 12 |                    0 |
    | Магазин 13 |                    0 |
    | Магазин 14 |                    0 |
    | Магазин 6  |                    5 |
    | Магазин 2  |                   10 |
    | Магазин 5  |                   10 |
    | Магазин 8  |                   10 |
    | Магазин 11 |                   10 |
    | Магазин 1  |                   15 |
    | Магазин 4  |                   15 |
    | Магазин 7  |                   20 |
    | Магазин 10 |                   20 |

    5 магазинів (`М3, М9, М12, М13, М14`) не отримали жодного товару. Причиною цьому є надостатня пропускна здатність між терміналами і складами. Аналіз вузьких місць системи буде показаний в наступному питанні.

4. Чи є вузькі місця, які можна усунути для покращення ефективності логістичної мережі?

    Вузькі місця, які суттєво обмежують пропускну здатність системи  - низька пропускна здатність між Терміналами і Складами. Збільшення пропускної здатності цих ребер, а також додаткові маршрути `(Т1, С4)` і `(Т2, С1)` суттево збільшать пропускну здатність всієї системи.

    Наприклад, на Склад 1 входить 25 од. товару, а зі складу до магазинів `М1 + М2 + М3 = 15 + 10 + 20 = 45` од. і в результаті М3 взагалі не отримує товару.

    Наведемо таблицю вхідних і вихідних потоків по складам:

    | Склад      | Вхід (од.) | Вихід (од.) | Різниця |
    |:-----------|-----------:|------------:|--------:|
    | Склад 1    |         25 |          45 |     -20 |
    | Склад 2    |         30 |          50 |     -20 |
    | Склад 3    |         30 |          45 |     -15 |
    | Склад 4    |         30 |          60 |     -30 |
    | **Всього** |    **115** |     **200** | **-85** |

    *Загальна пропускана здатність між складами і магазинами **200 од.**, а між терміналами і складами **115 од.**
    Тобто збільшення пропускної здатності між терміналами і складами на цифри в колонці Різниця дозволить загрузити систему на максимум.*

## Задача 2. Розширення функціоналу префіксного дерева

Реалізуйте два додаткових методи для класу Trie:

* `count_words_with_suffix(pattern)` для підрахунку кількості слів, що закінчуються заданим шаблоном;
* `has_prefix(prefix)` для перевірки наявності слів із заданим префіксом.

### Технічні умови

* Клас `Homework` має успадковувати базовий клас `Trie`.
* Методи повинні опрацьовувати помилки введення некоректних даних.
* Вхідні параметри обох методів мають бути рядками.
* Метод `count_words_with_suffix` має повертати ціле число.
* Метод `has_prefix` має повертати булеве значення.

### Реалізація [task_2.py](src/task_2.py)

Реалізовано клас `Homework`, в якому для пошуку слів по суфіксу додано `self._reversed_trie: Trie` для збереження слів в реверсному порядку. Реалізовано методи `count_words_with_suffix(pattern)` та `has_prefix(prefix)` згідно з умовами завдання. Також реалізовано метод `keys_with_suffix(suffix)`, який повертає слова по заданому суфіксу.

#### Вивід тесту завдання

Для запуску використовуйте команду

```bash
poetry run python src/task_2.py
```

```text
Inserted words: ['apple', 'application', 'banana', 'cat']
----------------------------------------
Count words with suffix "e": 1
Count words with suffix "ion": 1
Count words with suffix "a": 1
Count words with suffix "at": 1
Count words with suffix "z": 0
----------------------------------------
Words with suffix "e": ['apple']
Words with suffix "ion": ['application']
Words with suffix "a": ['banana']
Words with suffix "at": ['cat']
Words with suffix "z": []
----------------------------------------
Has prefix "app": True
Has prefix "bat": False
Has prefix "ban": True
Has prefix "ca": True
----------------------------------------
All tests passed.
```
